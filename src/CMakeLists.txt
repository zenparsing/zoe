project(zoe)

cmake_minimum_required(VERSION 3.15)

set(CMAKE_CXX_STANDARD 17)

set(cc_directory ${CMAKE_SOURCE_DIR}/../../ChakraCore)
set(cc_build_directory ${cc_directory}/Build/VcBuild/bin/x64_debug)

set(uv_directory ${CMAKE_SOURCE_DIR}/../../libuv)
set(uv_build_directory ${uv_directory}/out/cmake/Debug)

include_directories(
  ${cc_directory}/lib/jsrt
  ${uv_directory}/include
)

add_executable(
  zoe
  main.cpp
  url.cpp
  os.cpp
  js_engine.cpp
  sys_object.cpp
)

target_link_libraries(
  zoe
  ${cc_build_directory}/ChakraCore.lib
  ${uv_build_directory}/uv.lib
)

set(MAIN_JS_HEADER "AUTOGENERATED\nstatic const std::string main_js = u8R\"js(")
set(MAIN_JS_FOOTER ")js\";")

configure_file(
  ${CMAKE_SOURCE_DIR}/main.js
  ${CMAKE_SOURCE_DIR}/main.js.h
  @ONLY
  NEWLINE_STYLE LF
)

configure_file(
  ${cc_build_directory}/ChakraCore.dll
  ${CMAKE_CURRENT_BINARY_DIR}/ChakraCore.dll
  COPYONLY
)

configure_file(
  ${uv_build_directory}/uv.dll
  ${CMAKE_CURRENT_BINARY_DIR}/uv.dll
  COPYONLY
)
